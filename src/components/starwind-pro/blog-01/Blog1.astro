---
import type { HTMLAttributes } from "astro/types";
import { tv } from "tailwind-variants";

import { AspectRatio } from "@/components/starwind/aspect-ratio";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/starwind/card";

export interface BlogPost {
  title: string;
  description: string;
  pubDate: string;
  author: string;
  heroImage: string;
  href: string;
}

interface Props extends HTMLAttributes<"section"> {
  /** Section heading */
  heading?: string;
  /** Section description */
  description?: string;
  /** Array of blog posts to display */
  posts: BlogPost[];
}

const blog1Styles = tv({
  base: "@container mx-auto w-full max-w-7xl px-4",
});

const {
  heading = "Latest Articles",
  description = "Insights and tutorials from our engineering team.",
  posts,
  class: className,
  ...rest
} = Astro.props;
---

<section class={blog1Styles({ class: className })} {...rest}>
  <div class="mb-8 flex flex-col items-start justify-between gap-4 @lg:flex-row @lg:items-end">
    <div>
      <h2 class="font-heading text-3xl font-semibold tracking-tight @xl:text-4xl @3xl:text-5xl">
        {heading}
      </h2>
      {description && <p class="text-muted-foreground mt-2 text-lg">{description}</p>}
    </div>
  </div>

  <div class="grid gap-6 @md:grid-cols-2 @xl:grid-cols-3">
    {
      posts.map((post) => (
        <article class="group relative isolate block h-full">
          <a href={post.href} class="absolute inset-0 z-1">
            <span class="sr-only">{post.title}</span>
          </a>
          <Card class="group-hover:ring-foreground/50 h-full overflow-hidden transition-shadow">
            <img
              src={post.heroImage}
              alt={post.title}
              class="aspect-video h-auto w-full object-cover"
            />
            <CardHeader>
              <CardTitle class="line-clamp-2 group-hover:underline">{post.title}</CardTitle>
              <div class="text-muted-foreground flex items-center gap-2 text-sm">
                <span>{post.author}</span>
                <span>â€¢</span>
                <time datetime={post.pubDate}>{post.pubDate}</time>
              </div>
            </CardHeader>
            <CardContent>
              <p class="text-muted-foreground line-clamp-3">{post.description}</p>
            </CardContent>
          </Card>
        </article>
      ))
    }
  </div>
</section>
